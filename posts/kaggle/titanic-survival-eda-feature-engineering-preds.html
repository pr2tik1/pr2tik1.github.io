<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pratik Kumar">
<meta name="dcterms.date" content="2021-03-21">

<title>Titanic Survival Prediction – devExplore</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background: black;
      }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Titanic Survival Prediction – devExplore">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://pr2tik1.github.io/posts/post-images/10.png">
<meta name="twitter:image-height" content="501">
<meta name="twitter:image-width" content="514">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">devExplore</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Pratikpkb"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/pratik-kumar04/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pr2tik1"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://medium.com/@pr2tik1"> <i class="bi bi-medium" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Titanic Survival Prediction</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Data Science</div>
                <div class="quarto-category">Data Visualization</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Machine Learning</div>
                <div class="quarto-category">Feature Engineering</div>
                <div class="quarto-category">Kaggle</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Pratik Kumar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 21, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#a.-import-data" id="toc-a.-import-data" class="nav-link" data-scroll-target="#a.-import-data">A. Import Data</a></li>
  <li><a href="#b.-dataset-exploration" id="toc-b.-dataset-exploration" class="nav-link" data-scroll-target="#b.-dataset-exploration">B. Dataset exploration:</a>
  <ul class="collapse">
  <li><a href="#b.3.-analyzing-the-embarked-feature" id="toc-b.3.-analyzing-the-embarked-feature" class="nav-link" data-scroll-target="#b.3.-analyzing-the-embarked-feature">B.3. Analyzing the Embarked feature</a></li>
  <li><a href="#b.4.-analyzing-cabin-feature" id="toc-b.4.-analyzing-cabin-feature" class="nav-link" data-scroll-target="#b.4.-analyzing-cabin-feature">B.4. Analyzing Cabin feature</a></li>
  <li><a href="#b.5.-analyzing-the-age-feature" id="toc-b.5.-analyzing-the-age-feature" class="nav-link" data-scroll-target="#b.5.-analyzing-the-age-feature">B.5. Analyzing the Age feature</a></li>
  <li><a href="#b.6.-analyzing-the-fare-feature" id="toc-b.6.-analyzing-the-fare-feature" class="nav-link" data-scroll-target="#b.6.-analyzing-the-fare-feature">B.6. Analyzing the Fare feature</a></li>
  </ul></li>
  <li><a href="#c.-feature-scaling-and-engineering" id="toc-c.-feature-scaling-and-engineering" class="nav-link" data-scroll-target="#c.-feature-scaling-and-engineering">C. Feature Scaling and Engineering</a>
  <ul class="collapse">
  <li><a href="#c.1.-handling-the-missing-values" id="toc-c.1.-handling-the-missing-values" class="nav-link" data-scroll-target="#c.1.-handling-the-missing-values">C.1. Handling the Missing Values:<br></a></li>
  <li><a href="#c.2.-encoding" id="toc-c.2.-encoding" class="nav-link" data-scroll-target="#c.2.-encoding">C.2. Encoding</a></li>
  </ul></li>
  <li><a href="#d.-visualizations" id="toc-d.-visualizations" class="nav-link" data-scroll-target="#d.-visualizations">D. Visualizations</a></li>
  <li><a href="#e.-model-training-and-predicting" id="toc-e.-model-training-and-predicting" class="nav-link" data-scroll-target="#e.-model-training-and-predicting">E. Model Training and Predicting</a>
  <ul class="collapse">
  <li><a href="#e.1.-logistic-regression" id="toc-e.1.-logistic-regression" class="nav-link" data-scroll-target="#e.1.-logistic-regression">E.1. Logistic Regression</a></li>
  <li><a href="#e.2.-random-forest" id="toc-e.2.-random-forest" class="nav-link" data-scroll-target="#e.2.-random-forest">E.2. Random Forest</a></li>
  <li><a href="#e.3.-k-nearest-neighbours" id="toc-e.3.-k-nearest-neighbours" class="nav-link" data-scroll-target="#e.3.-k-nearest-neighbours">E.3. K-Nearest Neighbours</a></li>
  <li><a href="#e.4.-gaussian-naive-bayes-classifier" id="toc-e.4.-gaussian-naive-bayes-classifier" class="nav-link" data-scroll-target="#e.4.-gaussian-naive-bayes-classifier">E.4. Gaussian Naive Bayes Classifier</a></li>
  <li><a href="#e.5.-c-support-vector-classifier" id="toc-e.5.-c-support-vector-classifier" class="nav-link" data-scroll-target="#e.5.-c-support-vector-classifier">E.5. C-Support Vector Classifier</a></li>
  <li><a href="#e.6.-decision-tree" id="toc-e.6.-decision-tree" class="nav-link" data-scroll-target="#e.6.-decision-tree">E.6. Decision Tree</a></li>
  <li><a href="#e.7.-linear-classifiers-with-sgd-training." id="toc-e.7.-linear-classifiers-with-sgd-training." class="nav-link" data-scroll-target="#e.7.-linear-classifiers-with-sgd-training.">E.7. Linear classifiers with SGD training.</a></li>
  </ul></li>
  <li><a href="#ensemble-learning" id="toc-ensemble-learning" class="nav-link" data-scroll-target="#ensemble-learning">Ensemble Learning</a></li>
  <li><a href="#submission" id="toc-submission" class="nav-link" data-scroll-target="#submission">Submission</a></li>
  <li><a href="#thankyou" id="toc-thankyou" class="nav-link" data-scroll-target="#thankyou">Thankyou!</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome to the Titanic Survival Prediction project, a classic challenge that serves as the perfect starting point for anyone looking to dive into the world of Machine Learning and data competitions on Kaggle. This project involves building a predictive model to determine which passengers survived the infamous Titanic disaster, a task that will guide you through essential steps in data science, from feature engineering to model development and evaluation.</p>
<p>This competition is designed to help you get comfortable with the Kaggle platform and machine learning workflows. You’ll be using Python to explore the data, perform feature engineering, visualize key trends, and develop a predictive model that can accurately classify survivors. For more details, visit the <a href="https://www.kaggle.com/c/titanic/overview">competition page</a> and check out <a href="https://www.youtube.com/watch?v=8yZMXCaFshs">Kaggle’s YouTube video</a> for a comprehensive introduction.</p>
<ol type="1">
<li><strong>Import Data</strong>: Load the Titanic dataset to begin the exploration and analysis.</li>
<li><strong>Feature Engineering</strong>: Transform raw data into meaningful features that improve model performance.</li>
<li><strong>Data Visualization</strong>: Analyze and visualize the data to uncover patterns and insights.</li>
<li><strong>Model Development</strong>: Build and train machine learning models to predict passenger survival.</li>
<li><strong>Model Testing</strong>: Evaluate model accuracy and fine-tune parameters to optimize results.</li>
<li><strong>Prediction and Submission</strong>: Generate survival predictions and submit them to the Kaggle leaderboard.</li>
</ol>
<p>Embark on this journey to not only enhance your data science skills but also understand the power of predictive modeling in real-world scenarios.</p>
</section>
<section id="a.-import-data" class="level2">
<h2 class="anchored" data-anchor-id="a.-import-data">A. Import Data</h2>
<div id="a7b0bdc1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="40f6f8a6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">'../input/titanic/train.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">'../input/titanic/test.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b.-dataset-exploration" class="level2">
<h2 class="anchored" data-anchor-id="b.-dataset-exploration">B. Dataset exploration:</h2>
<hr>
<div id="767d9445" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="b.1.-types-of-variables" class="level4">
<h4 class="anchored" data-anchor-id="b.1.-types-of-variables">B.1. Types of Variables</h4>
<div id="2779b423" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find categorical variables</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>categorical <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> train.columns <span class="cf">if</span> train[var].dtype<span class="op">==</span><span class="st">'O'</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'There are </span><span class="sc">{}</span><span class="st"> categorical variables'</span>.<span class="bu">format</span>(<span class="bu">len</span>(categorical)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 5 categorical variables</code></pre>
</div>
</div>
<div id="c8429ded" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find numerical variables</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>numerical <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> train.columns <span class="cf">if</span> train[var].dtype<span class="op">!=</span><span class="st">'O'</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'There are </span><span class="sc">{}</span><span class="st"> numerical variables'</span>.<span class="bu">format</span>(<span class="bu">len</span>(numerical)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 7 numerical variables</code></pre>
</div>
</div>
<section id="viewing-the-categorical-terms" class="level5">
<h5 class="anchored" data-anchor-id="viewing-the-categorical-terms">Viewing the Categorical terms :</h5>
<div id="0cebb581" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [train,test]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset <span class="kw">in</span> data:</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Filter categorical variables</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    categorical_columns <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> dataset.dtypes.index <span class="cf">if</span> dataset.dtypes[x]<span class="op">==</span><span class="st">'object'</span>]    </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exclude ID cols and source:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    categorical_columns <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> categorical_columns <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> [<span class="st">'PassengerId'</span>,<span class="st">'Ticket'</span>,<span class="st">'Name'</span>,<span class="st">'Cabin'</span>]]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Print frequency of categories</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (<span class="st">'</span><span class="ch">\n</span><span class="st">Frequency of Categories for variable </span><span class="sc">%s</span><span class="st">'</span><span class="op">%</span>col)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (train[col].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Frequency of Categories for variable Sex
Sex
male      577
female    314
Name: count, dtype: int64

Frequency of Categories for variable Embarked
Embarked
S    644
C    168
Q     77
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
</section>
<section id="b.2.-detecting-missing-values" class="level4">
<h4 class="anchored" data-anchor-id="b.2.-detecting-missing-values">B.2. Detecting Missing Values</h4>
<div id="e7d25d0b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>train.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            177
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64</code></pre>
</div>
</div>
<div id="c0c570f9" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>train.isnull().mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>PassengerId    0.000000
Survived       0.000000
Pclass         0.000000
Name           0.000000
Sex            0.000000
Age            0.198653
SibSp          0.000000
Parch          0.000000
Ticket         0.000000
Fare           0.000000
Cabin          0.771044
Embarked       0.002245
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="missing-data-overview" class="level4">
<h4 class="anchored" data-anchor-id="missing-data-overview">Missing Data Overview</h4>
<p>The train dataset has 12 features, with missing values observed in the following features:</p>
<ul>
<li><strong>Age</strong>: Missing in 19.86% of the records</li>
<li><strong>Cabin</strong>: Missing in 77.10% of the records</li>
<li><strong>Embarked</strong>: Missing in 0.22% of the records</li>
</ul>
</section>
<section id="analysis-and-assumptions-about-missing-data" class="level4">
<h4 class="anchored" data-anchor-id="analysis-and-assumptions-about-missing-data">Analysis and Assumptions About Missing Data</h4>
<section id="cabin" class="level5">
<h5 class="anchored" data-anchor-id="cabin">Cabin</h5>
<p>The <strong>Cabin</strong> feature has the highest proportion of missing values (77.10%). This substantial amount of missing data might suggest that:</p>
<ul>
<li>For many individuals who did not survive, the cabin information was not recorded or available.</li>
<li>Survivors, on the other hand, may have been able to provide this information.</li>
</ul>
<p>The missingness here could be due to the nature of the records or circumstances surrounding the individuals who did not survive, making this data likely to fall into the <em>Missing Not At Random (MNAR)</em> category. This means the missingness is related to the unobserved value itself or other factors not accounted for.</p>
</section>
<section id="age" class="level5">
<h5 class="anchored" data-anchor-id="age">Age</h5>
<p>The <strong>Age</strong> feature has missing values in about 22% of the records. This could be due to:</p>
<ul>
<li>Missing age information for individuals who did not survive.</li>
<li>Survivors possibly being able to provide their age when asked.</li>
</ul>
<p>This type of missing data might also be categorized as <em>Missing Not At Random (MNAR)</em> if the likelihood of missing data is related to whether the individual survived or other unobserved factors.</p>
</section>
<section id="embarked" class="level5">
<h5 class="anchored" data-anchor-id="embarked">Embarked</h5>
<p>The <strong>Embarked</strong> feature has a very small proportion of missing values (0.22%). This is a very minor amount and is likely due to random occurrences.</p>
<p>Such a small percentage of missing data is often considered <em>Missing Completely At Random (MCAR)</em>, meaning the missingness is unrelated to the observed or unobserved data.</p>
</section>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<ul>
<li><strong>Cabin</strong> and <strong>Age</strong> features likely fall into the MNAR category due to possible relationships between missingness and other factors like survival status.</li>
<li>The <strong>Embarked</strong> feature’s missing values are likely MCAR, as the missingness appears random and does not correlate with other data aspects.</li>
</ul>
</section>
<section id="b.3.-outliers-detection" class="level4">
<h4 class="anchored" data-anchor-id="b.3.-outliers-detection">B.3. Outliers detection</h4>
<div id="61397143" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> train.boxplot(column<span class="op">=</span><span class="st">'Age'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>fig.set_title(<span class="st">''</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>fig.set_ylabel(<span class="st">'Age'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> train.boxplot(column<span class="op">=</span><span class="st">'Fare'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>fig.set_title(<span class="st">''</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>fig.set_ylabel(<span class="st">'Fare'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Text(0, 0.5, 'Fare')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="titanic-survival-eda-feature-engineering-preds_files/figure-html/cell-10-output-2.png" width="659" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f4c2271e" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> train.Age.hist(bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>fig.set_ylabel(<span class="st">'Number of passengers'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>fig.set_xlabel(<span class="st">'Age'</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> train.Fare.hist(bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>fig.set_ylabel(<span class="st">'Number of passengers'</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>fig.set_xlabel(<span class="st">'Fare'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Text(0.5, 0, 'Fare')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="titanic-survival-eda-feature-engineering-preds_files/figure-html/cell-11-output-2.png" width="667" height="503" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="b.3.-analyzing-the-embarked-feature" class="level3">
<h3 class="anchored" data-anchor-id="b.3.-analyzing-the-embarked-feature">B.3. Analyzing the Embarked feature</h3>
<div id="c6233777" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>train[train.Embarked.isnull()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">61</td>
<td>62</td>
<td>1</td>
<td>1</td>
<td>Icard, Miss. Amelie</td>
<td>female</td>
<td>38.0</td>
<td>0</td>
<td>0</td>
<td>113572</td>
<td>80.0</td>
<td>B28</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">829</td>
<td>830</td>
<td>1</td>
<td>1</td>
<td>Stone, Mrs. George Nelson (Martha Evelyn)</td>
<td>female</td>
<td>62.0</td>
<td>0</td>
<td>0</td>
<td>113572</td>
<td>80.0</td>
<td>B28</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>Embarked</code> feature, which records the port of embarkation for passengers, has a very small proportion of missing values (0.22%). This low percentage of missing data suggests a specific pattern in how the data might be missing.</p>
<section id="possible-reasons-for-missing-values" class="level4">
<h4 class="anchored" data-anchor-id="possible-reasons-for-missing-values">Possible Reasons for Missing Values</h4>
<ul>
<li><p><strong>Consistency Among Passengers:</strong> For passengers who share the same ticket, cabin, and fare, it is unlikely that the missing <code>Embarked</code> data is due to discrepancies in their records. This is because passengers with identical ticket and cabin information would typically have consistent embarkation data.</p></li>
<li><p><strong>Data Generation During Dataset Construction:</strong> The missing <code>Embarked</code> values could have resulted from data entry or construction processes. For example, if data was manually entered or generated, some records might have been incomplete due to errors or omissions during the data preparation phase.</p></li>
</ul>
</section>
<section id="nature-of-missing-data" class="level4">
<h4 class="anchored" data-anchor-id="nature-of-missing-data">Nature of Missing Data</h4>
<p>Given that the missing values in the <code>Embarked</code> feature are minimal and appear to be random rather than systematic, we can categorize this missing data as:</p>
<ul>
<li><strong>Missing Completely At Random (MCAR):</strong> The missingness of the <code>Embarked</code> data is likely unrelated to both the values of the <code>Embarked</code> feature itself and any other features in the dataset. The small percentage of missing data indicates that these omissions do not follow a discernible pattern and are likely due to random errors in data entry or processing.</li>
</ul>
<p>In summary, the missing values in the <code>Embarked</code> feature are random and not indicative of any underlying patterns related to the data’s other aspects. This randomness supports the classification of this missing data as MCAR.</p>
</section>
</section>
<section id="b.4.-analyzing-cabin-feature" class="level3">
<h3 class="anchored" data-anchor-id="b.4.-analyzing-cabin-feature">B.4. Analyzing Cabin feature</h3>
<div id="03886ac4" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'cabin_null'</span>] <span class="op">=</span> np.where(train.Cabin.isnull(),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>train.groupby([<span class="st">'Survived'</span>])[<span class="st">'cabin_null'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Survived
0    0.876138
1    0.602339
Name: cabin_null, dtype: float64</code></pre>
</div>
</div>
<p>The above figures indicates that the missing data is more in the case of passengers not survived(=0).<br></p>
<p><strong>There is a systematic loss of data: people who did not survive tend to have more information missing. Presumably, the method chosen to gather the information, contributes to the generation of these missing data.</strong></p>
</section>
<section id="b.5.-analyzing-the-age-feature" class="level3">
<h3 class="anchored" data-anchor-id="b.5.-analyzing-the-age-feature">B.5. Analyzing the Age feature</h3>
<div id="402ba8ac" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'age_null'</span>] <span class="op">=</span> np.where(train.Age.isnull(),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>train.groupby([<span class="st">'Survived'</span>])[<span class="st">'age_null'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Survived
0    0.227687
1    0.152047
Name: age_null, dtype: float64</code></pre>
</div>
</div>
<p><strong>There is a systematic loss of data: people who did not survive tend to have more information missing. Presumably, the method chosen to gather the information, contributes to the generation of these missing data.</strong></p>
</section>
<section id="b.6.-analyzing-the-fare-feature" class="level3">
<h3 class="anchored" data-anchor-id="b.6.-analyzing-the-fare-feature">B.6. Analyzing the Fare feature</h3>
<p>The distribution of Fare is skewed, so in principle, we shouldn’t estimate outliers using the mean plus minus 3 standard deviations methods, which assumes a normal distribution of the data.</p>
<div id="b8777015" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>total_passengers <span class="op">=</span> <span class="bu">float</span>(train.shape[<span class="dv">0</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Total number of passengers: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(train.shape[<span class="dv">0</span>]))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Passengers that paid more than 65: </span><span class="sc">{:.2f}</span><span class="st">%'</span>.<span class="bu">format</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    (train[train.Fare <span class="op">&gt;</span> <span class="dv">65</span>].shape[<span class="dv">0</span>] <span class="op">/</span> total_passengers) <span class="op">*</span> <span class="dv">100</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'passengers that paid more than 100: </span><span class="sc">{}</span><span class="st"> %'</span>.<span class="bu">format</span>((</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    train[train.Fare <span class="op">&gt;</span> <span class="dv">100</span>].shape[<span class="dv">0</span>]<span class="op">/</span> total_passengers)<span class="op">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total number of passengers: 891
Passengers that paid more than 65: 13.02%
passengers that paid more than 100: 5.948372615039282 %</code></pre>
</div>
</div>
<p>There <em>is <strong>unusual</strong> high values of <strong>Fares</strong> observed</em>, the reason is found as follows:</p>
<div id="f3315fd6" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#at the most extreme outliers</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>train[train.Fare<span class="op">&gt;</span><span class="dv">300</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
<th data-quarto-table-cell-role="th">cabin_null</th>
<th data-quarto-table-cell-role="th">age_null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">258</td>
<td>259</td>
<td>1</td>
<td>1</td>
<td>Ward, Miss. Anna</td>
<td>female</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>PC 17755</td>
<td>512.3292</td>
<td>NaN</td>
<td>C</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">679</td>
<td>680</td>
<td>1</td>
<td>1</td>
<td>Cardeza, Mr. Thomas Drake Martinez</td>
<td>male</td>
<td>36.0</td>
<td>0</td>
<td>1</td>
<td>PC 17755</td>
<td>512.3292</td>
<td>B51 B53 B55</td>
<td>C</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">737</td>
<td>738</td>
<td>1</td>
<td>1</td>
<td>Lesurer, Mr. Gustave J</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>PC 17755</td>
<td>512.3292</td>
<td>B101</td>
<td>C</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>These three people have the same ticket number, indicating that they were travelling together. The Fare price in this case, 512 is the price of 3 tickets, and not one. <strong>This is why, it is unusually high.</strong></p>
<section id="b.7.-categorical-values" class="level4">
<h4 class="anchored" data-anchor-id="b.7.-categorical-values">B.7. Categorical Values :</h4>
<div id="c7690b44" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:45.942852Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:45.942241Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:45.954297Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:45.953677Z&quot;}" data-papermill="{&quot;duration&quot;:0.073536,&quot;end_time&quot;:&quot;2021-04-23T20:32:45.954503&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:45.880967&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of categories in the variable Name: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(train.Name.unique())))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of categories in the variable Gender: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(train.Sex.unique())))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of categories in the variable Ticket: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(train.Ticket.unique())))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of categories in the variable Cabin: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(train.Cabin.unique())))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of categories in the variable Embarked: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(train.Embarked.unique())))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Total number of passengers in the Titanic: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="bu">len</span>(train)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of categories in the variable Name: 891
Number of categories in the variable Gender: 2
Number of categories in the variable Ticket: 681
Number of categories in the variable Cabin: 148
Number of categories in the variable Embarked: 4
Total number of passengers in the Titanic: 891</code></pre>
</div>
</div>
<div id="6bb807ba" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:46.082239Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:46.081643Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:46.084965Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:46.084306Z&quot;}" data-papermill="{&quot;duration&quot;:0.070042,&quot;end_time&quot;:&quot;2021-04-23T20:32:46.085116&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:46.015074&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>drop_column <span class="op">=</span> [<span class="st">'cabin_null'</span>,<span class="st">'age_null'</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>train.drop(drop_column , axis <span class="op">=</span><span class="dv">1</span>  ,inplace <span class="op">=</span> <span class="va">True</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="c.-feature-scaling-and-engineering" class="level2">
<h2 class="anchored" data-anchor-id="c.-feature-scaling-and-engineering">C. Feature Scaling and Engineering</h2>
<p>Feature scaling is a technique used to standardize the range of independent variables or features of data. In machine learning and data analysis, scaling is important because it helps improve the performance and training stability of models.</p>
<section id="c.1.-handling-the-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="c.1.-handling-the-missing-values">C.1. Handling the Missing Values:<br></h3>
<p>The dataset contains missing values in several features. To address these, we apply different strategies based on the nature of each feature:</p>
<div id="96f5aea5" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:46.442663Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:46.442051Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:46.444810Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:46.445348Z&quot;}" data-papermill="{&quot;duration&quot;:0.068828,&quot;end_time&quot;:&quot;2021-04-23T20:32:46.445522&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:46.376694&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>train.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            177
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64</code></pre>
</div>
</div>
<div id="5e33139e" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:46.567380Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:46.566835Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:46.573905Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:46.574381Z&quot;}" data-papermill="{&quot;duration&quot;:0.069182,&quot;end_time&quot;:&quot;2021-04-23T20:32:46.574549&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:46.505367&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>test.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>PassengerId      0
Pclass           0
Name             0
Sex              0
Age             86
SibSp            0
Parch            0
Ticket           0
Fare             1
Cabin          327
Embarked         0
dtype: int64</code></pre>
</div>
</div>
<div id="795e50a6" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:46.698254Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:46.697685Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:46.713090Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:46.712561Z&quot;}" data-papermill="{&quot;duration&quot;:0.078807,&quot;end_time&quot;:&quot;2021-04-23T20:32:46.713222&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:46.634415&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data_cleaner <span class="op">=</span> [test , train]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset <span class="kw">in</span> data_cleaner:    </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#completing missing age with median</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">'Age'</span>].fillna(dataset[<span class="st">'Age'</span>].median(), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#completing embarked with mode</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">'Embarked'</span>].fillna(dataset[<span class="st">'Embarked'</span>].mode()[<span class="dv">0</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#completing missing fare with median</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">'Fare'</span>].fillna(dataset[<span class="st">'Fare'</span>].median(), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#delete the train feature</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>train.drop([<span class="st">'Ticket'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>test.drop([<span class="st">'Ticket'</span>] , axis<span class="op">=</span><span class="dv">1</span> , inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="c.2.-encoding" class="level3">
<h3 class="anchored" data-anchor-id="c.2.-encoding">C.2. Encoding</h3>
<p>Encoding is a crucial step in data preprocessing, especially for machine learning and statistical modeling. It involves converting categorical variables (features that represent categories or groups) into numerical values that can be processed by machine learning algorithms.</p>
<section id="c.2.1.-cabin-feature" class="level4">
<h4 class="anchored" data-anchor-id="c.2.1.-cabin-feature">C.2.1. Cabin Feature</h4>
<div id="57671006" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:47.083372Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:47.082787Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:47.086162Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:47.085643Z&quot;}" data-papermill="{&quot;duration&quot;:0.071415,&quot;end_time&quot;:&quot;2021-04-23T20:32:47.086312&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:47.014897&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="21">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>drop_column <span class="op">=</span> [<span class="st">'Cabin'</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>train.drop(drop_column , axis <span class="op">=</span><span class="dv">1</span>  ,inplace <span class="op">=</span> <span class="va">True</span> )</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>test.drop(drop_column , axis <span class="op">=</span><span class="dv">1</span>  ,inplace <span class="op">=</span> <span class="va">True</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Cabin feature has been dropped from the dataset due to its high proportion of missing values (77.10%), which makes it less informative.</p>
</section>
<section id="c.2.2.-fare-feature" class="level4">
<h4 class="anchored" data-anchor-id="c.2.2.-fare-feature">C.2.2. Fare Feature</h4>
<div id="613fea04" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:47.333005Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:47.332078Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:47.348850Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:47.349278Z&quot;}" data-papermill="{&quot;duration&quot;:0.082134,&quot;end_time&quot;:&quot;2021-04-23T20:32:47.349462&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:47.267328&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> [train,test]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset <span class="kw">in</span> full_data:</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    dataset.loc[ dataset[<span class="st">'Fare'</span>] <span class="op">&lt;=</span> <span class="fl">7.91</span>, <span class="st">'Fare_Band'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Fare'</span>] <span class="op">&gt;</span> <span class="fl">7.91</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Fare'</span>] <span class="op">&lt;=</span> <span class="fl">14.454</span>), <span class="st">'Fare_Band'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Fare'</span>] <span class="op">&gt;</span> <span class="fl">14.454</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Fare'</span>] <span class="op">&lt;=</span> <span class="dv">31</span>), <span class="st">'Fare_Band'</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    dataset.loc[ dataset[<span class="st">'Fare'</span>] <span class="op">&gt;</span> <span class="dv">31</span>, <span class="st">'Fare_Band'</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">'Fare_Band'</span>] <span class="op">=</span> dataset[<span class="st">'Fare_Band'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    dataset.drop([<span class="st">'Fare'</span> ], axis <span class="op">=</span> <span class="dv">1</span> , inplace <span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Fare feature has been transformed into discrete fare bands. This transformation categorizes fare amounts into bins, which can simplify the modeling process and potentially reveal patterns.</p>
</section>
<section id="c.2.3.-age-feature" class="level4">
<h4 class="anchored" data-anchor-id="c.2.3.-age-feature">C.2.3. Age Feature</h4>
<div id="666a4f9d" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:47.594090Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:47.593120Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:47.614967Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:47.615359Z&quot;}" data-papermill="{&quot;duration&quot;:0.085178,&quot;end_time&quot;:&quot;2021-04-23T20:32:47.615536&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:47.530358&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> [test , train]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset <span class="kw">in</span> full_data:</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    dataset.loc[ dataset[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">10</span>, <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">10</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">15</span>), <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">15</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">20</span>), <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">20</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">25</span>), <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">25</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">30</span>), <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">30</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">45</span>), <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    dataset.loc[(dataset[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">45</span>) <span class="op">&amp;</span> (dataset[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">60</span>), <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    dataset.loc[ dataset[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">60</span>, <span class="st">'Age'</span>] <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">'Age'</span>] <span class="op">=</span> dataset[<span class="st">'Age'</span>].astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Age feature has been converted into age bins, categorizing age into discrete intervals. This transformation simplifies the feature and can help capture age-related patterns more effectively.</p>
</section>
<section id="c.2.4.-sex-and-embarked-feature" class="level4">
<h4 class="anchored" data-anchor-id="c.2.4.-sex-and-embarked-feature">C.2.4. Sex and Embarked Feature</h4>
<div id="a9fa506e" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> [test , train]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset <span class="kw">in</span> full_data:</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">'Embarked'</span>] <span class="op">=</span> dataset[<span class="st">'Embarked'</span>].<span class="bu">map</span>( {<span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>} ).astype(<span class="bu">int</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">'Sex'</span>] <span class="op">=</span> dataset[<span class="st">'Sex'</span>].<span class="bu">map</span>( {<span class="st">'female'</span>: <span class="dv">0</span>, <span class="st">'male'</span>: <span class="dv">1</span>} ).astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The categorical features Embarked and Sex have been encoded into numeric values. This encoding converts categorical variables into a format suitable for machine learning models.</p>
</section>
<section id="c.2.5.-droping-the-name-feature" class="level4">
<h4 class="anchored" data-anchor-id="c.2.5.-droping-the-name-feature">C.2.5. Droping the Name feature</h4>
<div id="8c151c1b" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>train.drop([<span class="st">'Name'</span>],axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>test.drop([<span class="st">'Name'</span>],axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Name feature, which does not provide useful information for modeling, has been removed from both the training and testing datasets.</p>
</section>
<section id="c.2.6.-family-size" class="level4">
<h4 class="anchored" data-anchor-id="c.2.6.-family-size">C.2.6. Family Size</h4>
<div id="f26450e0" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'family_size'</span>] <span class="op">=</span> train[<span class="st">'SibSp'</span>] <span class="op">+</span> train[<span class="st">'Parch'</span>] <span class="op">+</span> <span class="dv">1</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'family_size'</span>] <span class="op">=</span> test[<span class="st">'SibSp'</span>] <span class="op">+</span> test[<span class="st">'Parch'</span>] <span class="op">+</span> <span class="dv">1</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'IsAlone'</span>] <span class="op">=</span> <span class="dv">1</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'IsAlone'</span>] <span class="op">=</span> <span class="dv">1</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'IsAlone'</span>].loc[train[<span class="st">'family_size'</span>] <span class="op">&gt;</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'IsAlone'</span>].loc[test[<span class="st">'family_size'</span>] <span class="op">&gt;</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>test.drop([<span class="st">'SibSp'</span> , <span class="st">'Parch'</span>], axis <span class="op">=</span> <span class="dv">1</span> , inplace <span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>train.drop([<span class="st">'SibSp'</span>,<span class="st">'Parch'</span> ], axis <span class="op">=</span> <span class="dv">1</span> , inplace <span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A new feature, family_size, is created by combining SibSp (siblings/spouses aboard) and Parch (parents/children aboard). This feature provides insight into the size of the family traveling with the passenger.</p>
<div id="308ff39e" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>test.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>PassengerId    0
Pclass         0
Sex            0
Age            0
Embarked       0
Fare_Band      0
family_size    0
IsAlone        0
dtype: int64</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="d.-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="d.-visualizations">D. Visualizations</h2>
<hr>
<p>Let’s get some insights !</p>
<div id="ee7828dd" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(train, col<span class="op">=</span><span class="st">"Survived"</span>, row<span class="op">=</span><span class="st">"Sex"</span>, hue<span class="op">=</span><span class="st">"Embarked"</span>, height<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>g.<span class="bu">map</span>(plt.hist, <span class="st">"Pclass"</span>, edgecolor<span class="op">=</span><span class="st">"w"</span>).add_legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="titanic-survival-eda-feature-engineering-preds_files/figure-html/cell-29-output-1.png" width="646" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Observations
<ul>
<li>From above graph we observe that more number of females survived as compared to males. The female survivors were more from the first class and male from third class were the most to die.</li>
<li>The 3rd class people were the most affected, that is they less survived where as 1st class people survived is maximum than others.</li>
<li>The second class has almost equal survived and couldn’t survive number of people. And also we notice many of the passengers Embarked from “S”.</li>
</ul></li>
</ul>
<div id="241a614e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> [<span class="dv">8</span>,<span class="dv">5</span>])</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sns.violinplot(x<span class="op">=</span><span class="st">"Fare_Band"</span>, y<span class="op">=</span><span class="st">"Age"</span>, data<span class="op">=</span>train, hue<span class="op">=</span><span class="st">'Survived'</span>,palette<span class="op">=</span><span class="st">'coolwarm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="titanic-survival-eda-feature-engineering-preds_files/figure-html/cell-30-output-1.png" width="662" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Mostly farebands are greater at the Age Group <strong>“4”</strong>. Survival also has <em>greater area corresponding to age group <strong>“4”</strong>.</em></p>
<div id="f57d9cf6" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>train[[<span class="st">'family_size'</span>, <span class="st">'Survived'</span>]].groupby([<span class="st">'family_size'</span>], as_index<span class="op">=</span><span class="va">False</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">family_size</th>
<th data-quarto-table-cell-role="th">Survived</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0.303538</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>0.552795</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>0.578431</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>0.724138</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>0.200000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>0.136364</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>0.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>11</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="d74bf8ce" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> sns.catplot(x<span class="op">=</span><span class="st">'family_size'</span>, y<span class="op">=</span><span class="st">'Survived'</span>, hue<span class="op">=</span><span class="st">'Sex'</span>, data<span class="op">=</span>train, aspect<span class="op">=</span><span class="dv">3</span>, kind<span class="op">=</span><span class="st">'point'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="titanic-survival-eda-feature-engineering-preds_files/figure-html/cell-32-output-1.png" width="1492" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We find with increase in family size the survival rate decreases.</p>
<div id="c01aafb7" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(train.drop(<span class="st">'PassengerId'</span>,axis<span class="op">=</span><span class="dv">1</span>).corr(), square<span class="op">=</span><span class="va">True</span>, annot<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="titanic-survival-eda-feature-engineering-preds_files/figure-html/cell-33-output-1.png" width="753" height="763" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Undestanding the Correlation matrix:
<ul>
<li>The FareBand and Pclass are highly correlated(-0.63) although negative, next to them is FareBand and IsAlone correlation(-0.57).</li>
<li>The Sex and Survived also have good correlation of (-0.54).</li>
<li>But as observed IsAlone and Family_size has the largest negative correlation (-0.69) is liable as the Family size and being alone are two opposite categories.</li>
</ul></li>
</ul>
</section>
<section id="e.-model-training-and-predicting" class="level2">
<h2 class="anchored" data-anchor-id="e.-model-training-and-predicting">E. Model Training and Predicting</h2>
<hr>
<p>Spitting the data in ro train and test</p>
<div id="7287feff" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:53.361482Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:53.360855Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:53.556072Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:53.555545Z&quot;}" data-papermill="{&quot;duration&quot;:0.26645,&quot;end_time&quot;:&quot;2021-04-23T20:32:53.556212&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:53.289762&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> train.drop(<span class="st">'Survived'</span> , axis <span class="op">=</span> <span class="dv">1</span> )</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> train[<span class="st">'Survived'</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>X_train ,X_test , y_train , y_test <span class="op">=</span> train_test_split(X , y , test_size <span class="op">=</span> <span class="fl">0.3</span> , random_state <span class="op">=</span><span class="dv">102</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Also we need to remove Id of passengers for prediction,</p>
<div id="179cd937" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:53.839140Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:53.838169Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:53.841458Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:53.840978Z&quot;}" data-papermill="{&quot;duration&quot;:0.079744,&quot;end_time&quot;:&quot;2021-04-23T20:32:53.841593&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:53.761849&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="34">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>X_train<span class="op">=</span>X_train.drop([<span class="st">'PassengerId'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> X_test.drop([<span class="st">'PassengerId'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Importing models from scikit learn module. The objective is to classify the passenger survivior into two classes: 0 or 1, hence this is a binary classification for which we will be using classifiers. Following part of this notebook compares and finds the best model suitable for the data based upon accuracy metrics.</p>
<div id="b70bc1f9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:54.128224Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:54.127560Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:54.355129Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:54.354528Z&quot;}" data-papermill="{&quot;duration&quot;:0.3031,&quot;end_time&quot;:&quot;2021-04-23T20:32:54.355270&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:54.052170&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="35">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importing all models</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression, SGDClassifier</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="e.1.-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="e.1.-logistic-regression">E.1. Logistic Regression</h3>
<div id="d44ce2fe" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:54.649046Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:54.648362Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:54.663747Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:54.664292Z&quot;}" data-papermill="{&quot;duration&quot;:0.093643,&quot;end_time&quot;:&quot;2021-04-23T20:32:54.664464&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:54.570821&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="36">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>logmodel <span class="op">=</span> LogisticRegression()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>logmodel.fit(X_train , y_train)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>pred_l <span class="op">=</span> logmodel.predict(X_test)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>acc_l <span class="op">=</span> accuracy_score(y_test , pred_l)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>acc_l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>79.1044776119403</code></pre>
</div>
</div>
</section>
<section id="e.2.-random-forest" class="level3">
<h3 class="anchored" data-anchor-id="e.2.-random-forest">E.2. Random Forest</h3>
<div id="3b2431ab" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:54.951492Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:54.950892Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:55.173900Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:55.173365Z&quot;}" data-papermill="{&quot;duration&quot;:0.2952,&quot;end_time&quot;:&quot;2021-04-23T20:32:55.174028&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:54.878828&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>random_forest <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span> <span class="dv">100</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>random_forest.fit(X_train, y_train)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>pred_rf <span class="op">=</span> random_forest.predict(X_test)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>acc_rf <span class="op">=</span> accuracy_score(y_test , pred_rf)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>acc_rf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>81.71641791044776</code></pre>
</div>
</div>
</section>
<section id="e.3.-k-nearest-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="e.3.-k-nearest-neighbours">E.3. K-Nearest Neighbours</h3>
<div id="fde9d9ba" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:55.462822Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:55.462222Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:55.481314Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:55.481851Z&quot;}" data-papermill="{&quot;duration&quot;:0.096048,&quot;end_time&quot;:&quot;2021-04-23T20:32:55.482009&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:55.385961&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier(n_neighbors <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>knn.fit(X_train, y_train)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>pred_knn <span class="op">=</span> knn.predict(X_test)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>acc_knn <span class="op">=</span> accuracy_score(y_test , pred_knn)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>acc_knn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>79.8507462686567</code></pre>
</div>
</div>
</section>
<section id="e.4.-gaussian-naive-bayes-classifier" class="level3">
<h3 class="anchored" data-anchor-id="e.4.-gaussian-naive-bayes-classifier">E.4. Gaussian Naive Bayes Classifier</h3>
<div id="2885390f" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:55.770805Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:55.770180Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:55.781545Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:55.782062Z&quot;}" data-papermill="{&quot;duration&quot;:0.089308,&quot;end_time&quot;:&quot;2021-04-23T20:32:55.782221&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:55.692913&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>gaussian <span class="op">=</span> GaussianNB()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>gaussian.fit(X_train, y_train)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>pred_gb <span class="op">=</span> gaussian.predict(X_test)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>acc_gb <span class="op">=</span> accuracy_score(y_test , pred_gb)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>acc_gb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>77.98507462686567</code></pre>
</div>
</div>
</section>
<section id="e.5.-c-support-vector-classifier" class="level3">
<h3 class="anchored" data-anchor-id="e.5.-c-support-vector-classifier">E.5. C-Support Vector Classifier</h3>
<div id="53dd0aa6" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:56.074024Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:56.073097Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:56.102944Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:56.103434Z&quot;}" data-papermill="{&quot;duration&quot;:0.105985,&quot;end_time&quot;:&quot;2021-04-23T20:32:56.103602&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:55.997617&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>svc <span class="op">=</span> SVC()</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>svc.fit(X_train, y_train)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>pred_svc <span class="op">=</span> svc.predict(X_test)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>acc_svc <span class="op">=</span> accuracy_score(y_test , pred_svc)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>acc_svc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>84.70149253731343</code></pre>
</div>
</div>
</section>
<section id="e.6.-decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="e.6.-decision-tree">E.6. Decision Tree</h3>
<div id="6befa81b" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:56.397685Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:56.397048Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:56.404967Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:56.405437Z&quot;}" data-papermill="{&quot;duration&quot;:0.08648,&quot;end_time&quot;:&quot;2021-04-23T20:32:56.405611&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:56.319131&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="41">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>decision_tree <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>decision_tree.fit(X_train, y_train)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>pred_dt <span class="op">=</span> decision_tree.predict(X_test)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>acc_dt <span class="op">=</span> accuracy_score(y_test , pred_dt)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>acc_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>81.34328358208955</code></pre>
</div>
</div>
</section>
<section id="e.7.-linear-classifiers-with-sgd-training." class="level3">
<h3 class="anchored" data-anchor-id="e.7.-linear-classifiers-with-sgd-training.">E.7. Linear classifiers with SGD training.</h3>
<div id="d2e5842f" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:56.706350Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:56.703937Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:56.715328Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:56.715776Z&quot;}" data-papermill="{&quot;duration&quot;:0.090807,&quot;end_time&quot;:&quot;2021-04-23T20:32:56.715936&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:56.625129&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="42">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>sgd <span class="op">=</span> SGDClassifier()</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>sgd.fit(X_train, y_train)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>pred_sgd <span class="op">=</span> sgd.predict(X_test)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>acc_sgd <span class="op">=</span> accuracy_score(y_test , pred_sgd)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>acc_sgd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>68.65671641791045</code></pre>
</div>
</div>
<div id="32a9b8ec" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:56.875742Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:56.875152Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:56.879071Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:56.878599Z&quot;}" data-papermill="{&quot;duration&quot;:0.087595,&quot;end_time&quot;:&quot;2021-04-23T20:32:56.879201&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:56.791606&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="43">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Arranging the Accuracy results</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> pd.DataFrame({</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>: [<span class="st">'Logistic Regression'</span>, <span class="st">'Random Forrest'</span>,<span class="st">'K- Nearest Neighbour'</span> ,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">'Naive Bayes'</span> , <span class="st">'C-Support Vector Classifier'</span> , <span class="st">'Decision Tree'</span> , <span class="st">'Stochastic Gradient Descent'</span>],</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Score'</span>: [acc_l , acc_rf , acc_knn , acc_gb , acc_svc , </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>              acc_dt , acc_sgd]})</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>models.sort_values(by<span class="op">=</span><span class="st">'Score'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>C-Support Vector Classifier</td>
<td>84.701493</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Random Forrest</td>
<td>81.716418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Decision Tree</td>
<td>81.343284</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>K- Nearest Neighbour</td>
<td>79.850746</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Logistic Regression</td>
<td>79.104478</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Naive Bayes</td>
<td>77.985075</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Stochastic Gradient Descent</td>
<td>68.656716</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="ensemble-learning" class="level2">
<h2 class="anchored" data-anchor-id="ensemble-learning">Ensemble Learning</h2>
<div id="54a112b2" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:57.194519Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:57.193895Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:57.225611Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:57.224960Z&quot;}" data-papermill="{&quot;duration&quot;:0.117647,&quot;end_time&quot;:&quot;2021-04-23T20:32:57.225746&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:57.108099&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="44">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span>  test.drop([<span class="st">'PassengerId'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>p_l <span class="op">=</span> logmodel.predict(df_test)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>p_svc <span class="op">=</span> svc.predict(df_test)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>p_rf <span class="op">=</span> random_forest.predict(df_test)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>p_dt <span class="op">=</span> decision_tree.predict(df_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6cd48a02" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:57.382473Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:57.381852Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:57.384501Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:57.384910Z&quot;}" data-papermill="{&quot;duration&quot;:0.083898,&quot;end_time&quot;:&quot;2021-04-23T20:32:57.385072&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:57.301174&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="45">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>predict_combine <span class="op">=</span> np.zeros((df_test.shape[<span class="dv">0</span>]))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, test.shape[<span class="dv">0</span>]):</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">=</span> p_rf[i]<span class="op">+</span>p_svc[i]<span class="op">+</span>p_l[i]<span class="op">+</span>p_dt[i]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> temp<span class="op">&gt;=</span><span class="dv">2</span>:</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>        predict_combine[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>predict_combine <span class="op">=</span> predict_combine.astype(<span class="st">'int'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="submission" class="level2">
<h2 class="anchored" data-anchor-id="submission">Submission</h2>
<div id="94d3c336" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:57.688123Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:57.687211Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:57.693086Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:57.693579Z&quot;}" data-papermill="{&quot;duration&quot;:0.085841,&quot;end_time&quot;:&quot;2021-04-23T20:32:57.693765&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:57.607924&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="46">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> pd.DataFrame({</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">"PassengerId"</span>: test[<span class="st">"PassengerId"</span>],</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Survived"</span>: predict_combine</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>submission.to_csv(<span class="st">"submission.csv"</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="664065d9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-04-23T20:32:57.848777Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-04-23T20:32:57.847828Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-04-23T20:32:57.856131Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-04-23T20:32:57.856614Z&quot;}" data-papermill="{&quot;duration&quot;:0.087097,&quot;end_time&quot;:&quot;2021-04-23T20:32:57.856782&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-04-23T20:32:57.769685&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>submission.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>892</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>893</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>894</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>895</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>896</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="thankyou" class="level1">
<h1>Thankyou!</h1>
<ul>
<li>Kaggle: <a href="https://www.kaggle.com/code/pr2tik1/titanic-survival-eda-feature-engineering-preds">Notebook</a></li>
<li>Resources: <a href="https://www.udemy.com/share/1020r6AkcfcV5TQXo=/">Udemy Course</a>, Scikit-Learn docs</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pr2tik1\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="pr2tik1/pr2tik1.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../trademark.html">
<p>Trademark</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>